---
name: AI-Human Issue Classifier
description: Precise classification system to distinguish between AI-generated and human-created issues for selective automation
color: indigo
---

# AI-Human Issue Classifier Agent

ç²¾å¯†ãªIssueè­˜åˆ¥ã‚·ã‚¹ãƒ†ãƒ ã§ã€AIç”Ÿæˆã¨humanä½œæˆã®issueã‚’ç¢ºå®Ÿã«åŒºåˆ¥ã—ã€é©åˆ‡ãªå‡¦ç†ãƒ«ãƒ¼ãƒˆã«æŒ¯ã‚Šåˆ†ã‘ã¾ã™ã€‚

## Core Responsibilities

- **Issueèµ·æºè­˜åˆ¥**: AIç”Ÿæˆ vs äººé–“ä½œæˆã®ç¢ºå®Ÿãªåˆ¤å®š
- **è‡ªå‹•ãƒ©ãƒ™ãƒªãƒ³ã‚°**: ä½œæˆæ™‚ã®è‡ªå‹•åˆ†é¡ãƒ©ãƒ™ãƒ«ä»˜ä¸
- **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†**: Issueä½œæˆæ–¹æ³•ãƒ»çµŒè·¯ã®è¨˜éŒ²
- **é¸æŠçš„å‡¦ç†**: è­˜åˆ¥çµæœã«åŸºã¥ãå‡¦ç†ãƒ«ãƒ¼ãƒˆæ±ºå®š

## è­˜åˆ¥æ–¹æ³•è«–

### 1. ä½œæˆæ™‚ç‚¹ã§ã®è‡ªå‹•è­˜åˆ¥

```bash
# AIç”ŸæˆIssueä½œæˆæ™‚ã®è‡ªå‹•åˆ†é¡
create_ai_generated_issue() {
  local title="$1"
  local body="$2"
  local labels="$3"
  
  # AIç”Ÿæˆè­˜åˆ¥ãƒãƒ¼ã‚«ãƒ¼ã‚’æœ¬æ–‡ã«æŒ¿å…¥
  local enhanced_body=$(cat <<EOF
$body

---
ğŸ¤– **Generated by CC-DECK AI System**
- Created: $(date -Iseconds)
- Generator: $(whoami)@$(hostname)
- Workflow: Automated Issue Creation
- Classification: ai-generated

*This issue was automatically created by the CC-DECK AI-driven development system and is subject to automated processing workflows.*
EOF
)
  
  # ai-generatedãƒ©ãƒ™ãƒ«ã‚’è‡ªå‹•è¿½åŠ 
  local enhanced_labels="$labels,ai-generated,automated"
  
  # GitHub issueä½œæˆ
  local issue_id=$(gh issue create \
    --title "$title" \
    --body "$enhanced_body" \
    --label "$enhanced_labels" \
    --json number | jq -r '.number')
  
  # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¨˜éŒ²
  record_ai_issue_metadata "$issue_id" "$(date -Iseconds)" "cc-deck-ai"
  
  echo "$issue_id"
}

# äººé–“ä½œæˆIssueæ¤œå‡ºæ™‚ã®å‡¦ç†
detect_human_created_issue() {
  local issue_id="$1"
  
  # äººé–“ä½œæˆã®è­˜åˆ¥æ¡ä»¶ãƒã‚§ãƒƒã‚¯
  if is_human_created_issue "$issue_id"; then
    # human-createdãƒ©ãƒ™ãƒ«è¿½åŠ 
    gh issue edit "$issue_id" --add-label "human-created,manual-processing"
    
    # è‡ªå‹•å‡¦ç†é™¤å¤–ãƒªã‚¹ãƒˆã«è¿½åŠ 
    add_to_manual_processing_list "$issue_id"
    
    # ä½œæˆè€…ã«æ‰‹å‹•å‡¦ç†ã®é€šçŸ¥
    notify_manual_processing_required "$issue_id"
    
    echo "human-created"
  else
    echo "unknown"
  fi
}
```

### 2. æ—¢å­˜Issueåˆ†é¡ã‚·ã‚¹ãƒ†ãƒ 

```bash
# æ—¢å­˜Issueã®ä¸€æ‹¬åˆ†é¡
classify_existing_issues() {
  echo "ğŸ” Classifying existing issues..."
  
  # å…¨ã‚ªãƒ¼ãƒ—ãƒ³Issueå–å¾—
  local issues=$(gh issue list --state=open --json number,title,body,author,createdAt,labels)
  
  echo "$issues" | jq -r '.[].number' | while read -r issue_id; do
    classify_single_issue "$issue_id"
  done
}

# å€‹åˆ¥Issueåˆ†é¡
classify_single_issue() {
  local issue_id="$1"
  
  echo "ğŸ“‹ Classifying issue #$issue_id"
  
  # Issueè©³ç´°å–å¾—
  local issue_data=$(gh issue view "$issue_id" --json number,title,body,author,createdAt,labels,timelineItems)
  
  # åˆ†é¡åŸºæº–é©ç”¨
  local classification=$(determine_issue_origin "$issue_data")
  
  case "$classification" in
    "ai-generated")
      echo "ğŸ¤– Identified as AI-generated: #$issue_id"
      gh issue edit "$issue_id" --add-label "ai-generated,automated"
      record_ai_issue_metadata "$issue_id" "retroactive" "cc-deck-system"
      ;;
    "human-created")
      echo "ğŸ‘¤ Identified as human-created: #$issue_id"
      gh issue edit "$issue_id" --add-label "human-created,manual-processing"
      add_to_manual_processing_list "$issue_id"
      ;;
    "uncertain")
      echo "â“ Uncertain classification: #$issue_id - flagging for manual review"
      gh issue edit "$issue_id" --add-label "classification-uncertain"
      flag_for_manual_classification "$issue_id"
      ;;
  esac
}

# Issueèµ·æºåˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯
determine_issue_origin() {
  local issue_data="$1"
  
  local title=$(echo "$issue_data" | jq -r '.title')
  local body=$(echo "$issue_data" | jq -r '.body')
  local author=$(echo "$issue_data" | jq -r '.author.login')
  local created_at=$(echo "$issue_data" | jq -r '.createdAt')
  local existing_labels=$(echo "$issue_data" | jq -r '.labels[].name' | tr '\n' ',')
  
  local confidence_score=0
  local classification_reasons=()
  
  # æ—¢å­˜ãƒ©ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯
  if [[ "$existing_labels" =~ "ai-generated" ]]; then
    ((confidence_score += 50))
    classification_reasons+=("Existing ai-generated label")
    echo "ai-generated"
    return
  fi
  
  if [[ "$existing_labels" =~ "human-created" ]]; then
    ((confidence_score += 50))
    classification_reasons+=("Existing human-created label")
    echo "human-created"
    return
  fi
  
  # AIç”Ÿæˆãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º
  if [[ "$body" =~ "Generated by CC-DECK AI" ]]; then
    ((confidence_score += 40))
    classification_reasons+=("AI generation marker in body")
  fi
  
  # Phaseç³»ãƒ©ãƒ™ãƒ«ã®å­˜åœ¨ï¼ˆAIç”Ÿæˆã®å¯èƒ½æ€§ãŒé«˜ã„ï¼‰
  if [[ "$existing_labels" =~ "phase-" ]]; then
    ((confidence_score += 20))
    classification_reasons+=("Phase-based labeling pattern")
  fi
  
  # Requirementsç³»ãƒ©ãƒ™ãƒ«ã®å­˜åœ¨
  if [[ "$existing_labels" =~ "requirements-" ]]; then
    ((confidence_score += 15))
    classification_reasons+=("Requirements tracking labels")
  fi
  
  # ã‚¿ã‚¤ãƒˆãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ
  if [[ "$title" =~ ^Phase\ [0-9]+\.[0-9]+: ]]; then
    ((confidence_score += 25))
    classification_reasons+=("Structured phase title pattern")
  fi
  
  # ä½œæˆæ™‚åˆ»ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆä¸€æ‹¬ä½œæˆã®æ¤œå‡ºï¼‰
  local batch_creation=$(detect_batch_creation_pattern "$created_at" "$author")
  if [[ "$batch_creation" == "true" ]]; then
    ((confidence_score += 15))
    classification_reasons+=("Batch creation pattern")
  fi
  
  # æœ¬æ–‡æ§‹é€ åˆ†æ
  if [[ "$body" =~ "## " ]] && [[ "$body" =~ "### " ]]; then
    ((confidence_score += 10))
    classification_reasons+=("Structured markdown format")
  fi
  
  # åˆ†é¡æ±ºå®š
  if [[ $confidence_score -ge 40 ]]; then
    log_classification_decision "$issue_id" "ai-generated" "$confidence_score" "${classification_reasons[@]}"
    echo "ai-generated"
  elif [[ $confidence_score -le 10 ]]; then
    log_classification_decision "$issue_id" "human-created" "$confidence_score" "${classification_reasons[@]}"
    echo "human-created"
  else
    log_classification_decision "$issue_id" "uncertain" "$confidence_score" "${classification_reasons[@]}"
    echo "uncertain"
  fi
}
```

### 3. ä¸€æ‹¬ä½œæˆãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º

```bash
# ä¸€æ‹¬ä½œæˆãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¤œå‡º
detect_batch_creation_pattern() {
  local created_at="$1"
  local author="$2"
  
  # åŒã˜ä½œæˆè€…ã«ã‚ˆã‚‹è¿‘æ¥æ™‚åˆ»ã§ã®ä½œæˆã‚’æ¤œå‡º
  local creation_timestamp=$(date -d "$created_at" +%s)
  local time_window=1800  # 30åˆ†ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦
  
  # æ™‚é–“ç¯„å›²å†…ã§ã®åŒä¸€ä½œæˆè€…ã®issueæ•°ã‚’å–å¾—
  local nearby_issues=$(gh issue list --state=all --author="$author" --json createdAt | \
    jq --argjson timestamp "$creation_timestamp" --argjson window "$time_window" '
    [.[] | select(
      ((.createdAt | strptime("%Y-%m-%dT%H:%M:%SZ") | mktime) >= ($timestamp - $window)) and
      ((.createdAt | strptime("%Y-%m-%dT%H:%M:%SZ") | mktime) <= ($timestamp + $window))
    )] | length
  ')
  
  # 30åˆ†ä»¥å†…ã«3å€‹ä»¥ä¸Šã®issueãŒä½œæˆã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ä¸€æ‹¬ä½œæˆã¨åˆ¤å®š
  if [[ $nearby_issues -ge 3 ]]; then
    echo "true"
  else
    echo "false"
  fi
}

# åˆ†é¡æ±ºå®šã®ãƒ­ã‚°è¨˜éŒ²
log_classification_decision() {
  local issue_id="$1"
  local classification="$2"
  local confidence_score="$3"
  shift 3
  local reasons=("$@")
  
  local log_entry=$(jq -n \
    --arg issue_id "$issue_id" \
    --arg classification "$classification" \
    --argjson confidence "$confidence_score" \
    --argjson reasons "$(printf '%s\n' "${reasons[@]}" | jq -R . | jq -s .)" \
    --arg timestamp "$(date -Iseconds)" \
  '{
    issue_id: $issue_id,
    classification: $classification,
    confidence_score: $confidence,
    reasons: $reasons,
    timestamp: $timestamp
  }')
  
  echo "$log_entry" >> .classification-log.jsonl
}
```

### 4. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è­˜åˆ¥ã‚·ã‚¹ãƒ†ãƒ 

```bash
# ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ Issueç›£è¦–
monitor_new_issues() {
  echo "ğŸ‘€ Starting real-time issue monitoring..."
  
  # GitHub webhookã¾ãŸã¯ãƒãƒ¼ãƒªãƒ³ã‚°ã«ã‚ˆã‚‹æ–°è¦Issueæ¤œå‡º
  while true; do
    local new_issues=$(detect_new_issues_since_last_check)
    
    if [[ -n "$new_issues" ]]; then
      echo "$new_issues" | while read -r issue_id; do
        echo "ğŸ†• New issue detected: #$issue_id"
        
        # å³åº§ã«åˆ†é¡å®Ÿè¡Œ
        local classification=$(classify_single_issue "$issue_id")
        
        # åˆ†é¡çµæœã«åŸºã¥ãå‡¦ç†ãƒ«ãƒ¼ãƒˆæ±ºå®š
        route_issue_processing "$issue_id" "$classification"
      done
    fi
    
    sleep 60  # 1åˆ†é–“éš”ã§ãƒã‚§ãƒƒã‚¯
  done
}

# Issueå‡¦ç†ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
route_issue_processing() {
  local issue_id="$1"
  local classification="$2"
  
  case "$classification" in
    "ai-generated")
      echo "ğŸ¤– Routing AI-generated issue #$issue_id to automated processing"
      route_to_automated_processing "$issue_id"
      ;;
    "human-created")
      echo "ğŸ‘¤ Human-created issue #$issue_id - manual processing only"
      send_manual_processing_notification "$issue_id"
      ;;
    "uncertain")
      echo "â“ Uncertain issue #$issue_id - flagging for review"
      flag_for_manual_review "$issue_id"
      ;;
  esac
}
```

### 5. æ‰‹å‹•å‡¦ç†é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ 

```bash
# äººé–“ä½œæˆIssueé€šçŸ¥
send_manual_processing_notification() {
  local issue_id="$1"
  
  local issue_info=$(gh issue view "$issue_id" --json title,author,assignees)
  local title=$(echo "$issue_info" | jq -r '.title')
  local author=$(echo "$issue_info" | jq -r '.author.login')
  local assignees=$(echo "$issue_info" | jq -r '.assignees[].login' | tr '\n' ', ')
  
  local notification_message=$(cat <<EOF
ğŸ‘¤ **Human-Created Issue Detected**

**Issue #$issue_id**: $title
**Created by**: $author
**Assigned to**: ${assignees:-"Unassigned"}

This issue was created manually and will NOT be subject to automated processing.
Please handle this issue through normal manual workflows.

**Manual Actions Required:**
- Review and validate requirements
- Assign appropriate team members
- Track progress manually
- Close when completed

**Note**: Only AI-generated issues are processed through the automated approval system.
EOF
)
  
  # Slacké€šçŸ¥
  send_slack_notification "#manual-issues" "$notification_message" "warning" "Manual Processing Required"
  
  # Issueä½œæˆè€…ã¸ã®é€šçŸ¥
  gh issue comment "$issue_id" --body "ğŸ‘¤ **Manual Processing Required**

This issue has been identified as human-created and will be processed manually. It will not go through the automated approval workflow.

Please track progress and close this issue manually when completed."
}

# ä¸ç¢ºå®Ÿåˆ†é¡ã®æ‰‹å‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ•ãƒ©ã‚°
flag_for_manual_review() {
  local issue_id="$1"
  
  gh issue edit "$issue_id" --add-label "needs-classification-review"
  
  local review_message=$(cat <<EOF
â“ **Classification Review Required**

**Issue #$issue_id** could not be automatically classified as AI-generated or human-created.

**Please manually review and add the appropriate label:**
- \`ai-generated\` - For AI-created issues (will enter automated processing)
- \`human-created\` - For manually created issues (manual processing only)

**Classification Confidence**: Low
**Requires**: Manual intervention
EOF
)
  
  send_slack_notification "#classification-review" "$review_message" "warning" "Manual Classification Needed"
}
```

### 6. ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†

```bash
# AIç”ŸæˆIssueãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¨˜éŒ²
record_ai_issue_metadata() {
  local issue_id="$1"
  local created_at="$2"
  local generator="$3"
  
  local metadata=$(jq -n \
    --arg issue_id "$issue_id" \
    --arg created_at "$created_at" \
    --arg generator "$generator" \
    --arg hostname "$(hostname)" \
    --arg user "$(whoami)" \
  '{
    issue_id: $issue_id,
    classification: "ai-generated",
    created_at: $created_at,
    generator: $generator,
    hostname: $hostname,
    user: $user,
    automated_processing: true
  }')
  
  echo "$metadata" >> .ai-issues-metadata.jsonl
}

# æ‰‹å‹•å‡¦ç†ãƒªã‚¹ãƒˆç®¡ç†
add_to_manual_processing_list() {
  local issue_id="$1"
  
  local entry=$(jq -n \
    --arg issue_id "$issue_id" \
    --arg timestamp "$(date -Iseconds)" \
  '{
    issue_id: $issue_id,
    classification: "human-created",
    manual_processing: true,
    automated_processing: false,
    added_at: $timestamp
  }')
  
  echo "$entry" >> .manual-issues-list.jsonl
}
```

### 7. çµ±è¨ˆãƒ»ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½

```bash
# åˆ†é¡çµ±è¨ˆç”Ÿæˆ
generate_classification_stats() {
  local period="${1:-7d}"
  
  echo "ğŸ“Š Issue Classification Statistics (Last $period)"
  echo "================================================"
  
  # ç·Issueæ•°
  local total_issues=$(gh issue list --state=all --created="$period" --json number | jq length)
  echo "Total Issues: $total_issues"
  
  # AIç”ŸæˆIssueæ•°
  local ai_issues=$(gh issue list --state=all --created="$period" --label="ai-generated" --json number | jq length)
  echo "AI-Generated: $ai_issues ($(( ai_issues * 100 / total_issues ))%)"
  
  # äººé–“ä½œæˆIssueæ•°
  local human_issues=$(gh issue list --state=all --created="$period" --label="human-created" --json number | jq length)
  echo "Human-Created: $human_issues ($(( human_issues * 100 / total_issues ))%)"
  
  # ä¸ç¢ºå®Ÿåˆ†é¡æ•°
  local uncertain_issues=$(gh issue list --state=all --created="$period" --label="classification-uncertain" --json number | jq length)
  echo "Uncertain Classification: $uncertain_issues ($(( uncertain_issues * 100 / total_issues ))%)"
  
  # è‡ªå‹•å‡¦ç†å¯¾è±¡ç‡
  echo "Automated Processing Rate: $(( ai_issues * 100 / total_issues ))%"
}

# åˆ†é¡ç²¾åº¦ãƒ¬ãƒãƒ¼ãƒˆ
generate_classification_accuracy_report() {
  local manual_corrections=$(grep "manual_correction" .classification-log.jsonl | wc -l)
  local total_classifications=$(wc -l < .classification-log.jsonl)
  
  if [[ $total_classifications -gt 0 ]]; then
    local accuracy=$(( (total_classifications - manual_corrections) * 100 / total_classifications ))
    echo "Classification Accuracy: $accuracy% ($manual_corrections corrections out of $total_classifications)"
  else
    echo "Classification Accuracy: No data available"
  fi
}
```

ã“ã®ç²¾å¯†è­˜åˆ¥ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚Šã€AIç”Ÿæˆã¨humanä½œæˆã®issueã‚’ç¢ºå®Ÿã«åŒºåˆ¥ã—ã€é©åˆ‡ãªå‡¦ç†ãƒ«ãƒ¼ãƒˆã«æŒ¯ã‚Šåˆ†ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ—¢å­˜ã®issueã‚‚é¡åŠçš„ã«åˆ†é¡ã—ã€ä»Šå¾Œä½œæˆã•ã‚Œã‚‹issueã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è‡ªå‹•åˆ†é¡ã•ã‚Œã¾ã™ã€‚